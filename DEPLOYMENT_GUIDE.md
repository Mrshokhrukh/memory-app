# Memoryscape Production Deployment Guide

## Current Issues Fixed

### 1. Database Connection
- ✅ Updated server.js to use proper database connection module
- ✅ Added better error handling for production environment
- ✅ Fixed MongoDB connection configuration

### 2. Server Configuration
- ✅ Added root endpoint for health checks
- ✅ Updated CORS configuration for production
- ✅ Fixed render.yaml configuration
- ✅ Updated service name to match production URL

### 3. Environment Variables
- ✅ Updated render.yaml with correct environment variables
- ✅ Fixed PORT configuration (10000 for Render)
- ✅ Updated CLIENT_URL to match production frontend

## Production Deployment Steps

### 1. Render.com Deployment

1. **Connect Repository**: Link your GitHub repository to Render
2. **Create Web Service**:
   - Name: `memory-space-backend`
   - Environment: `Node`
   - Build Command: `npm install`
   - Start Command: `npm start`
   - Plan: `Starter`

### 2. Environment Variables

Set these environment variables in Render:

```
NODE_ENV=production
PORT=10000
MONGODB_URI=<your-mongodb-connection-string>
JWT_SECRET=<your-jwt-secret>
JWT_EXPIRE=7d
CLIENT_URL=https://memory-client-neon.vercel.app
```

### 3. Database Setup

1. **Create MongoDB Database** in Render
2. **Name**: `memoryscape-db`
3. **Database Name**: `memoryscape`
4. **User**: `memoryscape_user`

### 4. Deployment Verification

After deployment, test these endpoints:

```bash
# Health check
curl https://memory-space-backend.onrender.com/

# Registration test
curl -X POST https://memory-space-backend.onrender.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"name":"Test User","email":"test@example.com","password":"Test123"}'
```

## Local Development

### Start Local Server
```bash
cd server
MONGODB_URI=mongodb://localhost:27017/memoryscape \
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production \
NODE_ENV=development \
PORT=8800 \
npm start
```

### Start Local Client
```bash
cd client
npm run dev
```

## Troubleshooting

### Common Issues

1. **500 Internal Server Error**
   - Check MongoDB connection string
   - Verify environment variables are set
   - Check server logs in Render dashboard

2. **404 Not Found**
   - Ensure service is deployed and running
   - Check service name matches URL
   - Verify build and start commands

3. **CORS Errors**
   - Check CORS configuration in server.js
   - Verify CLIENT_URL environment variable
   - Ensure frontend URL is in allowed origins

### Debug Commands

```bash
# Test production health
curl -s https://memory-space-backend.onrender.com/api/health

# Test registration
curl -X POST https://memory-space-backend.onrender.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"name":"Debug User","email":"debug@example.com","password":"Test123"}'

# Check server status
curl -I https://memory-space-backend.onrender.com
```

## Production URLs

- **Frontend**: https://memory-client-neon.vercel.app
- **Backend**: https://memory-space-backend.onrender.com
- **API Docs**: https://memory-space-backend.onrender.com/api-docs

## Monitoring

1. **Render Dashboard**: Monitor service health and logs
2. **MongoDB Atlas**: Monitor database performance
3. **Vercel Dashboard**: Monitor frontend deployment

## Security Notes

- ✅ JWT_SECRET is auto-generated by Render
- ✅ CORS is properly configured
- ✅ Rate limiting is enabled
- ✅ Helmet security headers are active
- ✅ Input validation is implemented
